import logging
import os

from sqlalchemy import create_engine, text
from sqlalchemy.orm import Session

from EMInfraAPI.EMInfraImporter import EMInfraImporter
from EMInfraAPI.RequestHandler import RequestHandler
from EMInfraAPI.RequesterFactory import RequesterFactory
from EMInfraAPI.ResourceEnum import ResourceEnum
from EMInfraAPI.SettingsManager import SettingsManager
from ORM.Classes import Agent, Omgeving, AgentOmgeving
from ORM.Base import Base

if __name__ == '__main__':
    engine = create_engine('sqlite:///agents_all.db', echo=True)
    Base.metadata.create_all(engine)

    wegwijs_ovo_codes = [
        ["OVO002715", "POLITIEZONE : BRUSSEL - ELSENE", "ZPPZ 5339"],
        ["OVO002716", "POLITIEZONE : ETTERBEEK - SINT-LAMBRECHTS-WOLUWE - SINT-PIETERS-WOLUWE", "ZPPZ 5343"],
        ["OVO002718", "POLITIEZONE : GANSHOREN - JETTE - KOEKELBERG - SINT-AGATHA-BERCHEM - SINT-JANS-MOLENBEEK",
         "ZPPZ 5340"],
        ["OVO002719", "POLITIEZONE : EVERE - SCHAARBEEK - SINT-JOOST-TEN-NODE", "ZPPZ 5344"],
        ["OVO002720", "POLITIEZONE : OUDERGEM - UKKEL - WATERMAAL-BOSVOORDE", "ZPPZ 5342"],
        ["OVO002723", "POLITIEZONE : DROGENBOS - LINKEBEEK - SINT-GENESIUS-RODE", "ZPPZ 5403"],
        ["OVO002725", "Politiezone van Dilbeek", ""],
        ["OVO002727", "POLITIEZONE : BEVER - GALMAARDEN - GOOIK - HEME - LENNIK - PEPINGEN", "ZPPZ 5405"],
        ["OVO002728", "POLITIEZONE : KRAAINEM - WEZEMBEEK-OPPEM", "ZPPZ 5401"],
        ["OVO002729", "POLITIEZONE : MACHELEN - VILVOORDE", "ZPPZ 5411"],
        ["OVO002731", "Lokale Politiezone Mechelen - Willebroek", "PZ Mechelen - Willebroek"],
        ["OVO002732", "POLITIEZONE AALTER", "ZPPZ 5423"],
        ["OVO002733", "POLITIEZONE : AARTSELAAR - EDEGEM - HOVE - KONTICH - LINT", "ZPPZ 5349"],
        ["OVO002734", "POLITIEZONE : AFFLIGEM - LIEDEKERKE - ROOSDAAL - TERNAT", "ZPPZ 5407"],
        ["OVO002735", "POLITIEZONE : ALKEN - BORGLOON - HEERS - KORTESSEM - WELLEN", "ZPPZ 5379"],
        ["OVO002736", "POLITIEZONE : ALVERINGEM - LO-RENINGEN - VEURNE", "ZPPZ 5459"],
        ["OVO002737", "POLITIEZONE : BILZEN - HOESELT - RIEMST", "ZPPZ 5381"],
        ["OVO002738", "Politiezone van Zaventem", ""],
        ["OVO002739", "POLITIEZONE : HERSELT - HULSTHOUT - WESTERLO", "ZPPZ 5365"],
        ["OVO002740", "POLITIEZONE : HAMME - WAASMUNSTER", "ZPPZ 5435"],
        ["OVO002741", "POLITIEZONE : HOOGSTRATEN - MERKSPLAS - RIJKEVORSEL", "ZPPZ 5363"],
        ["OVO002742", "Politiezone van Lokeren", ""],
        ["OVO002743", "POLITIEZONE : LAARNE - WETTEREN - WICHELEN", "ZPPZ 5438"],
        ["OVO002744", "POLITIEZONE : GEEL - LAAKDAL - MEERHOUT", "ZPPZ 5366"],
        ["OVO002745", "Politiezone van Lier", ""],
        ["OVO002746", "POLITIEZONE : RANST - ZANDHOVEN", "ZPPZ 5354"],
        ["OVO002747", "Politiezone : Berlaar-Nijlen", "ZPPZ 5361"],
        ["OVO002748", "POLITIEZONE : BOECHOUT - BORSBEEK - MORTSEL - WIJNEGEM - WOMMELGEM", "ZPPZ 5351"],
        ["OVO002749", "Politiezone van Heist-op-den-Berg", ""],
        ["OVO002750", "POLITIEZONE : KAPELLE-OP-DEN-BOS - LONDERZEEL - MEISE", "ZPPZ 5409"],
        ["OVO002753", "POLITIEZONE : BOOM - HEMIKSEM - NIEL - RUMST - SCHELLE", "ZPPZ 5347"],
        ["OVO002754", "POLITIEZONE : BONHEIDEN - DUFFEL - PUTTE - SINT-KATELIJNE-WAVER", "ZPPZ 5359"],
        ["OVO002755", "POLITIEZONE : BORNEM - PUURS - SINT-AMANDS", "ZPPZ 5356"],
        ["OVO002756", "Politiezone van Schoten", ""],
        ["OVO002757", "POLITIEZONE : ESSEN - KALMTHOUT - WUUSTWEZEL", "ZPPZ 5350"],
        ["OVO002758", "Politiezone van Brasschaat", ""],
        ["OVO002759", "POLITIEZONE : KAPELLEN - STABROEK", "ZPPZ 5348"],
        ["OVO002760", "POLITIEZONE : BRECHT - MALLE - SCHILDE - ZOERSEL", "ZPPZ 5355"],
        ["OVO002761", "Politiezone van Leuven", ""],
        ["OVO002762", "POLITIEZONE : HERENT - KORTENBERG", "ZPPZ 5393"],
        ["OVO002763", "POLITIEZONE : BERTEM - HULDENBERG - OUD-HEVERLEE", "ZPPZ 5397"],
        ["OVO002764", "Politiezone van Tervuren", ""],
        ["OVO002765", "POLITIEZONE : HOEILAART - OVERIJSE", "ZPPZ 5402"],
        ["OVO002766", "POLITIEZONE : BUGGENHOUT - LEBBEKE", "ZPPZ 5437"],
        ["OVO002767", "POLITIEZONE : BOORTMEERBEEK - HAACHT - KEERBERGEN", "ZPPZ 5395"],
        ["OVO002768", "Politiezone van Aarschot", ""],
        ["OVO002769", "POLITIEZONE : BIERBEEK - BOUTERSEM - HOLSBEEK - LUBBEEK", "ZPPZ 5391"],
        ["OVO002770", "POLITIEZONE : DIEST- SCHERPENHEUVEL - ZICHEM", "ZPPZ 5396"],
        ["OVO002771", "POLITIEZONE : HOEGAARDEN - TIENEN", "ZPPZ 5392"],
        ["OVO002772", "POLITIEZONE : LANDEN - LINTER - ZOUTLEEUW", "ZPPZ 5390"],
        ["OVO002773", "POLITIEZONE : BEKKEVOORT - GEETBETS - GLABBEEK - KORTENAKEN - TIELT-WINGE", "ZPPZ 5389"],
        ["OVO002774", "POLITIEZONE : KAMPENHOUT - STEENOKKERZEEL - ZEMST", "ZPPZ 5412"],
        ["OVO002777", "Politiezone van Heusden-Zolder", ""],
        ["OVO002778", "POLITIEZONE : BERINGEN - HAM - TESSENDERLO", "ZPPZ 5373"],
        ["OVO002783", "Politiezone Lanaken-Maasmechelen", ""],
        ["OVO002784", "POLITIEZONE : DILSEN-STOKKEM - MAASEIK", "ZPPZ 5383"],
        ["OVO002785", "POLITIEZONE : HERSTAPPE - TONGEREN", "ZPPZ 5380"],
        ["OVO002786", "Politiezone van Antwerpen", ""],
        ["OVO002787", "POLITIEZONE NETELAND", "ZPPZ 5369"],
        ["OVO002788", "Politiezone van Voeren", ""],
        ["OVO002789", "POLITIEZONE : GINGELOM - NIEUWERKERKEN - SINT-TRUIDEN", "ZPPZ 5376"],
        ["OVO002790", "POLITIEZONE : HAMONT-ACHEL - NEERPELT - OVERPELT", "ZPPZ 5372"],
        ["OVO002791", "Politiezone van Lommel", ""],
        ["OVO002792", "POLITIEZONE : BOCHOLT - BREE - KINROOI - MEEUWEN-GRUITRODE", "ZPPZ 5385"],
        ["OVO002793", "POLITIEZONE : HECHTEL-EKSEL - LEOPOLDSBURG - PEER", "ZPPZ 5377"],
        ["OVO002794", "Politiezone van Brugge", ""],
        ["OVO002795", "POLITIEZONE : BERLARE - ZELE", "ZPPZ 5436"],
        ["OVO002796", "POLITIEZONE : DAMME - KNOKKE-HEIST", "ZPPZ 5446"],
        ["OVO002797", "POLITIEZONE : BLANKENBERGE - ZUIENKERKE", "ZPPZ 5445"],
        ["OVO002798", "Politiezone van Oostende", ""],
        ["OVO002799", "Politiezone van Middelkerke", ""],
        ["OVO002800", "POLITIEZONE : BREDENE - DE HAAN", "ZPPZ 5450"],
        ["OVO002801", "POLITIEZONE : GISTEL - ICHTEGEM - JABBEKE - OUDENBURG - TORHOUT", "ZPPZ 5452"],
        ["OVO002802", "POLITIEZONE : KORTRIJK - KUURNE - LENDELEDE", "ZPPZ 5456"],
        ["OVO002803", "POLITIEZONE : DEERLIJK - HARELBEKE", "ZPPZ 5458"],
        ["OVO002804", "POLITIEZONE : DIKSMUIDE - HOUTHULST - KOEKELARE - KORTEMARK", "ZPPZ 5460"],
        ["OVO002805", "Politiezone van Zwijndrecht", ""],
        ["OVO002806", "POLITIEZONE : DE PANNE - KOKSIJDE - NIEUWPOORT", "ZPPZ 5461"],
        ["OVO002807", "POLITIEZONE : KRUIBEKE - TEMSE", "ZPPZ 5433"],
        ["OVO002808", "POLITIEZONE : DENTERGEM -  INGELMUNSTER - MEULEBEKE - OOSTROZEBEKE - WIELSBEKE", "ZPPZ 5454"],
        ["OVO002809", "Politiezone Beveren - Sint-Gillis-Waas - Stekene", ""],
        ["OVO002810", "POLITIEZONE : HOOGLEDE - IZEGEM - ROESELARE", "ZPPZ 5453"],
        ["OVO002811",
         "POLITIEZONE : HEUVELLAND - IEPER - LANGEMARK - POELKAPELLE - MESEN - MOORSLEDE - POPERINGE - STADEN - VLETEREN - WERVIK - ZONNEBEKE",
         "ZPPZ 5462"],
        ["OVO002812", "POLITIEZONE : LEDEGEM - MENEN - WEVELGEM", "ZPPZ 5455"],
        ["OVO002813", "Politiezone van Gent", ""],
        ["OVO002814", "POLITIEZONE : LOCHRISTIE - MOERBEKE - WACHTEBEKE - ZELZATE", "ZPPZ 5416"],
        ["OVO002815", "Politiezone van Sint-Niklaas", ""],
        ["OVO002816", "POLITIEZONE : ANDERLECHT - SINT-GILLIS - VORST", "ZPPZ 5341"],
        ["OVO002817", "POLITIEZONE : ANZEGEM - AVELGEM - SPIERE-HELKIJN - WAREGEM - ZWEVEGEM", "ZPPZ 5457"],
        ["OVO002818", "POLITIEZONE : ARDOOIE - LICHTERVELDE - PITTEM - RUISELEDE - TIELT - WINGENE", "ZPPZ 5448"],
        ["OVO002819", "POLITIEZONE : ARENDONK - RAVELS - RETIE", "ZPPZ 5367"],
        ["OVO002820", "POLITIEZONE : ASSE - MERCHTEM - OPWIJK - WEMMEL", "ZPPZ 5408"],
        ["OVO002821", "POLITIEZONE : ASSENEDE - EVERGEM", "ZPPZ 5421"],
        ["OVO002822", "POLITIEZONE : BAARLE-HERTOG - BEERSE - KASTERLEE - LILLE - OUD-TURNHOUT - TURNHOUT - VOSSELAAR",
         "ZPPZ 5364"],
        ["OVO002823", "POLITIEZONE : BALEN - DESSEL - MOL", "ZPPZ 5368"],
        ["OVO002824", "POLITIEZONE : BEERNEM - OOSTKAMP - ZEDELGEM", "ZPPZ 5447"],
        ["OVO002825", "POLITIEZONE : BEGIJNENDIJK - ROTSELAAR - TREMELO", "ZPPZ 5399"],
        ["OVO002826", "Politiezone van Aalst", ""],
        ["OVO002827", "Politiezone van Ninove", ""],
        ["OVO002828", "POLITIEZONE : ERPE-MERE - LEDE", "ZPPZ 5441"],
        ["OVO002829", "POLITIEZONE : DENDERLEEUW - HAALTERT", "ZPPZ 5439"],
        ["OVO002830", "POLITIEZONE : GERAARDSBERGEN - LIERDE", "ZPPZ 5428"],
        ["OVO002831", "Politiezone van Ronse", ""],
        ["OVO002832", "POLITIEZONE : HERZELE - SINT-LIEVENS-HOUTEM - ZOTTEGEM", "ZPPZ 5429"],
        ["OVO002833", "POLITIEZONE : BRAKEL - HOREBEKE - MAARKEDAL - ZWALM", "ZPPZ 5426"],
        ["OVO002834", "Politiezone Vlaamse Ardennen: Kluisbergen – Kruisem – Oudenaarde – Wortegem-Petegem",
         "ZPPZ 5425"],
        ["OVO002836", "POLITIEZONE REGIO RHODE & SCHELDE", "PZ 5418"],
        ["OVO002837", "POLITIEZONE : DE PINTE - GAVERE - NAZARETH - SINT-MARTENS-LATEM", "ZPPZ 5419"],
        ["OVO002839", "Politiezone van Grimbergen", ""],
        ["OVO002840", "POLITIEZONE : EEKLO - KAPRIJKE - SINT-LAUREINS", "ZPPZ 5417"],
        ["OVO002841", "Politiezone van Dendermonde", ""],
        ["OVO002842", "Politiezone van Maldegem", "PZ MALDEGEM 5424"],
        ["OVO025090", "Politiezone Zennevallei", ""],
        ["OVO025174", "Politiezone Noorderkempen", ""],
        ["OVO025175", "Politiezone Zuiderkempen", ""],
        ["OVO027667", "Politiezone CARMA", ""],
        ["OVO028033", "Politiezone Deinze-Zulte-Lievegem", ""],
        ["OVO028159", "POLITIEZONE VOER EN DIJLE", "PZ VODI"],
        ["OVO028593", "Politiezone Getevallei", "PZ Getevallei"],
        ["OVO038797", "Lokale politiezone Hasselt/Zonhoven/Diepenbeek/Halen/Herk-de-Stad/Lummen",
         "Politiezone Limburg Regio Hoofdstad"]
    ]
